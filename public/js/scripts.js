!function(e,r,t){"use strict";L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(e){e=L.Util.setOptions(this,e)},createIcon:function(){var e=r.createElement("div"),t=this.options;return t.icon&&(e.innerHTML=this._createInner()),t.bgPos&&(e.style.backgroundPosition=-t.bgPos.x+"px "+-t.bgPos.y+"px"),this._setIconStyles(e,"icon-"+t.markerColor),e},_createInner:function(){var e,r="",t="",n="",a=this.options;return e=a.icon.slice(0,a.prefix.length+1)===a.prefix+"-"?a.icon:a.prefix+"-"+a.icon,a.spin&&"string"==typeof a.spinClass&&(r=a.spinClass),a.iconColor&&("white"===a.iconColor||"black"===a.iconColor?t="icon-"+a.iconColor:n="style='color: "+a.iconColor+"' "),"<i "+n+"class='"+a.extraClasses+" "+a.prefix+" "+e+" "+r+" "+t+"'></i>"},_setIconStyles:function(e,r){var t,n=this.options,a=L.point(n["shadow"===r?"shadowSize":"iconSize"]);t="shadow"===r?L.point(n.shadowAnchor||n.iconAnchor):L.point(n.iconAnchor),!t&&a&&(t=a.divideBy(2,!0)),e.className="awesome-marker-"+r+" "+n.className,t&&(e.style.marginLeft=-t.x+"px",e.style.marginTop=-t.y+"px"),a&&(e.style.width=a.x+"px",e.style.height=a.y+"px")},createShadow:function(){var e=r.createElement("div");return this._setIconStyles(e,"shadow"),e}}),L.AwesomeMarkers.icon=function(e){return new L.AwesomeMarkers.Icon(e)}}(this,document),function e(r,t,n){function a(i,l){if(!t[i]){if(!r[i]){var s="function"==typeof require&&require;if(!l&&s)return s(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[i]={exports:{}};r[i][0].call(c.exports,function(e){var t=r[i][1][e];return a(t?t:e)},c,c.exports,e,r,t,n)}return t[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,r,t){angular.module("nemLogging",[]),angular.module("nemLogging").provider("nemDebug",function(){var r=null;return r=e("debug"),this.$get=function(){return r},this.debug=r,this});var n=function(e,r){return function(){return e.apply(r,arguments)}};angular.module("nemLogging").provider("nemSimpleLogger",["nemDebugProvider",function(e){var r,t,a,o,i,l,s,u,c;u=e.debug,a=["debug","info","warn","error","log"],r={};for(s in a)c=a[s],r[c]=s;return i=function(e,r,t){return e>=r?t():void 0},o=function(e){var r;if(r=!1,!e)return r;for(s in a)if(c=a[s],r=null!=e[c]&&"function"==typeof e[c],!r)break;return r},l=function(e,r){var t,n;t=u(e),n={};for(s in a)c=a[s],n[c]="debug"===c?t:r[c];return n},t=function(){function e(e){var t;if(this.$log=e,this.spawn=n(this.spawn,this),!this.$log)throw"internalLogger undefined";if(!o(this.$log))throw"@$log is invalid";this.doLog=!0,t={},a.forEach(function(e){return function(n){return t[n]=function(t){return e.doLog?i(r[n],e.currentLevel,function(){return e.$log[n](t)}):void 0},e[n]=t[n]}}(this)),this.LEVELS=r,this.currentLevel=r.error}return e.prototype.spawn=function(r){if("string"==typeof r){if(!o(this.$log))throw"@$log is invalid";if(!u)throw"nemDebug is undefined this is probably the light version of this library sep debug logggers is not supported!";return l(r,this.$log)}return new e(r||this.$log)},e}(),this.decorator=["$log",function(e){var n;return n=new t(e),n.currentLevel=r.debug,n}],this.$get=["$log",function(e){return new t(e)}],this}])},{debug:2}],2:[function(e,r,t){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function a(){var e=arguments,r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var a=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))}),e.splice(o,0,n),e}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(r){}}function l(){var e;try{e=t.storage.debug}catch(r){}return e}function s(){try{return window.localStorage}catch(e){}}t=r.exports=e("./debug"),t.log=o,t.formatArgs=a,t.save=i,t.load=l,t.useColors=n,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:s(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(l())},{"./debug":3}],3:[function(e,r,t){function n(){return t.colors[c++%t.colors.length]}function a(e){function r(){}function a(){var e=a,r=+new Date,o=r-(u||r);e.diff=o,e.prev=u,e.curr=r,u=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=n());var i=Array.prototype.slice.call(arguments);i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&(i=["%o"].concat(i));var l=0;i[0]=i[0].replace(/%([a-z%])/g,function(r,n){if("%%"===r)return r;l++;var a=t.formatters[n];if("function"==typeof a){var o=i[l];r=a.call(e,o),i.splice(l,1),l--}return r}),"function"==typeof t.formatArgs&&(i=t.formatArgs.apply(e,i));var s=a.log||t.log||console.log.bind(console);s.apply(e,i)}r.enabled=!1,a.enabled=!0;var o=t.enabled(e)?a:r;return o.namespace=e,o}function o(e){t.save(e);for(var r=(e||"").split(/[\s,]+/),n=r.length,a=0;n>a;a++)r[a]&&(e=r[a].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function i(){t.enable("")}function l(e){var r,n;for(r=0,n=t.skips.length;n>r;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;n>r;r++)if(t.names[r].test(e))return!0;return!1}function s(e){return e instanceof Error?e.stack||e.message:e}t=r.exports=a,t.coerce=s,t.disable=i,t.enable=o,t.enabled=l,t.humanize=e("ms"),t.names=[],t.skips=[],t.formatters={};var u,c=0},{ms:4}],4:[function(e,r,t){function n(e){if(e=""+e,!(e.length>1e4)){var r=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*d;case"days":case"day":case"d":return t*c;case"hours":case"hour":case"hrs":case"hr":case"h":return t*u;case"minutes":case"minute":case"mins":case"min":case"m":return t*s;case"seconds":case"second":case"secs":case"sec":case"s":return t*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}}function a(e){return e>=c?Math.round(e/c)+"d":e>=u?Math.round(e/u)+"h":e>=s?Math.round(e/s)+"m":e>=l?Math.round(e/l)+"s":e+"ms"}function o(e){return i(e,c,"day")||i(e,u,"hour")||i(e,s,"minute")||i(e,l,"second")||e+" ms"}function i(e,r,t){return r>e?void 0:1.5*r>e?Math.floor(e/r)+" "+t:Math.ceil(e/r)+" "+t+"s"}var l=1e3,s=60*l,u=60*s,c=24*u,d=365.25*c;r.exports=function(e,r){return r=r||{},"string"==typeof e?n(e):r["long"]?o(e):a(e)}},{}]},{},[1]),function(angular){"use strict";angular.module("leaflet-directive",[]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",function(e,r,t,n,a){return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(r){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return r}}],link:function(e,o,i,l){function s(){isNaN(i.width)?o.css("width",i.width):o.css("width",i.width+"px")}function u(){isNaN(i.height)?o.css("height",i.height):o.css("height",i.height+"px")}var c=n.isDefined,d=t.setDefaults(e.defaults,i.id),f=a.getAvailableMapEvents(),p=a.addEvents;e.mapId=i.id,r.setDirectiveControls({},i.id),c(i.width)&&(s(),e.$watch(function(){return o[0].getAttribute("width")},function(){s(),g.invalidateSize()})),c(i.height)&&(u(),e.$watch(function(){return o[0].getAttribute("height")},function(){u(),g.invalidateSize()}));var g=new L.Map(o[0],t.getMapCreationDefaults(i.id));if(l._leafletMap.resolve(g),c(i.center)||c(i.lfCenter)||g.setView([d.center.lat,d.center.lng],d.center.zoom),!c(i.tiles)&&!c(i.layers)){var v=L.tileLayer(d.tileLayer,d.tileLayerOptions);v.addTo(g),r.setTiles(v,i.id)}if(c(g.zoomControl)&&c(d.zoomControlPosition)&&g.zoomControl.setPosition(d.zoomControlPosition),c(g.zoomControl)&&d.zoomControl===!1&&g.zoomControl.removeFrom(g),c(g.zoomsliderControl)&&c(d.zoomsliderControl)&&d.zoomsliderControl===!1&&g.zoomsliderControl.removeFrom(g),!c(i.eventBroadcast)){var y="broadcast";p(g,f,"eventName",e,y)}g.whenReady(function(){r.setMap(g,i.id)}),e.$on("$destroy",function(){t.reset(),g.remove(),r.unresolveMap(i.id)}),e.$on("invalidateSize",function(){g.invalidateSize()})}}}]),angular.module("leaflet-directive").factory("leafletBoundsHelpers",["$log","leafletHelpers",function(e,r){function t(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}var n=r.isArray,a=r.isNumber,o=r.isFunction,i=r.isDefined;return{createLeafletBounds:function(e){return t(e)?L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng]):void 0},isValidBounds:t,createBoundsFromArray:function(r){return n(r)&&2===r.length&&n(r[0])&&n(r[1])&&2===r[0].length&&2===r[1].length&&a(r[0][0])&&a(r[0][1])&&a(r[1][0])&&a(r[1][1])?{northEast:{lat:r[0][0],lng:r[0][1]},southWest:{lat:r[1][0],lng:r[1][1]}}:void e.error("[AngularJS - Leaflet] The bounds array is not valid.")},createBoundsFromLeaflet:function(r){if(!(i(r)&&o(r.getNorthEast)&&o(r.getSouthWest)))return void e.error("[AngularJS - Leaflet] The leaflet bounds is not valid object.");var t=r.getNorthEast(),n=r.getSouthWest();return{northEast:{lat:t.lat,lng:t.lng},southWest:{lat:n.lat,lng:n.lng}}}}}]),angular.module("leaflet-directive").factory("leafletControlHelpers",["$rootScope","$log","leafletHelpers","leafletLayerHelpers","leafletMapDefaults",function(e,r,t,n,a){var o=t.isDefined,i=t.isObject,l=n.createLayer,s={},u=t.errorHeader+" [Controls] ",c=function(e,r,t){var n=a.getDefaults(t);if(!n.controls.layers.visible)return!1;var l=!1;return i(e)&&Object.keys(e).forEach(function(r){var t=e[r];o(t.layerOptions)&&t.layerOptions.showOnSelector===!1||(l=!0)}),i(r)&&Object.keys(r).forEach(function(e){var t=r[e];o(t.layerParams)&&t.layerParams.showOnSelector===!1||(l=!0)}),l},d=function(e){var r=a.getDefaults(e),t={collapsed:r.controls.layers.collapsed,position:r.controls.layers.position,autoZIndex:!1};angular.extend(t,r.controls.layers.options);var n;return n=r.controls.layers&&o(r.controls.layers.control)?r.controls.layers.control.apply(this,[[],[],t]):new L.control.layers([],[],t)},f={draw:{isPluginLoaded:function(){return angular.isDefined(L.Control.Draw)?!0:(r.error(u+" Draw plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Draw(e)}},scale:{isPluginLoaded:function(){return!0},checkValidParams:function(){return!0},createControl:function(e){return new L.control.scale(e)}},fullscreen:{isPluginLoaded:function(){return angular.isDefined(L.Control.Fullscreen)?!0:(r.error(u+" Fullscreen plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Fullscreen(e)}},search:{isPluginLoaded:function(){return angular.isDefined(L.Control.Search)?!0:(r.error(u+" Search plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Search(e)}},custom:{},minimap:{isPluginLoaded:function(){return angular.isDefined(L.Control.MiniMap)?!0:(r.error(u+" Minimap plugin is not loaded."),!1)},checkValidParams:function(e){return o(e.layer)?!0:(r.warn(u+' minimap "layer" option should be defined.'),!1)},createControl:function(e){var t=l(e.layer);return o(t)?new L.Control.MiniMap(t,e):void r.warn(u+' minimap control "layer" could not be created.')}}};return{layersControlMustBeVisible:c,isValidControlType:function(e){return-1!==Object.keys(f).indexOf(e)},createControl:function(e,r){return f[e].checkValidParams(r)?f[e].createControl(r):void 0},updateLayersControl:function(e,r,t,n,a,i){var l,u=s[r],f=c(n,a,r);if(o(u)&&t){for(l in i.baselayers)u.removeLayer(i.baselayers[l]);for(l in i.overlays)u.removeLayer(i.overlays[l]);e.removeControl(u),delete s[r]}if(f){u=d(r),s[r]=u;for(l in n){var p=o(n[l].layerOptions)&&n[l].layerOptions.showOnSelector===!1;!p&&o(i.baselayers[l])&&u.addBaseLayer(i.baselayers[l],n[l].name)}for(l in a){var g=o(a[l].layerParams)&&a[l].layerParams.showOnSelector===!1;!g&&o(i.overlays[l])&&u.addOverlay(i.overlays[l],a[l].name)}e.addControl(u)}return f}}}]),angular.module("leaflet-directive").service("leafletData",["$log","$q","leafletHelpers",function(e,r,t){var n=t.getDefer,a=t.getUnresolvedDefer,o=t.setResolvedDefer,i={},l=this,s=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},u=["map","tiles","layers","paths","markers","geoJSON","UTFGrid","decorations","directiveControls"];u.forEach(function(e){i[e]={}}),this.unresolveMap=function(e){var r=t.obtainEffectiveMapId(i.map,e);u.forEach(function(e){i[e][r]=void 0})},u.forEach(function(e){var r=s(e);l["set"+r]=function(r,t){var n=a(i[e],t);n.resolve(r),o(i[e],t)},l["get"+r]=function(r){var t=n(i[e],r);return t.promise}})}]),angular.module("leaflet-directive").service("leafletDirectiveControlsHelpers",["$log","leafletData","leafletHelpers",function(e,r,t){var n=t.isDefined,a=t.isString,o=t.isObject,i=t.errorHeader,l=i+"[leafletDirectiveControlsHelpers",s=function(t,i,s,u){var c=l+".extend] ",d={};if(!n(i))return void e.error(c+"thingToAddName cannot be undefined");if(a(i)&&n(s)&&n(u))d[i]={create:s,clean:u};else{if(!o(i)||n(s)||n(u))return void e.error(c+"incorrect arguments");d=i}r.getDirectiveControls().then(function(e){angular.extend(e,d),r.setDirectiveControls(e,t)})};return{extend:s}}]),angular.module("leaflet-directive").service("leafletGeoJsonHelpers",["leafletHelpers","leafletIterators",function(e,r){var t=e,n=r,a=function(e,r){return this.lat=e,this.lng=r,this},o=function(e){return Array.isArray(e)&&2===e.length?e[1]:t.isDefined(e.type)&&"Point"===e.type?+e.coordinates[1]:+e.lat},i=function(e){return Array.isArray(e)&&2===e.length?e[0]:t.isDefined(e.type)&&"Point"===e.type?+e.coordinates[0]:+e.lng},l=function(e){if(t.isUndefined(e))return!1;if(t.isArray(e)){if(2===e.length&&t.isNumber(e[0])&&t.isNumber(e[1]))return!0}else if(t.isDefined(e.type)&&"Point"===e.type&&t.isArray(e.coordinates)&&2===e.coordinates.length&&t.isNumber(e.coordinates[0])&&t.isNumber(e.coordinates[1]))return!0;var r=n.all(["lat","lng"],function(r){return t.isDefined(e[r])&&t.isNumber(e[r])});return r},s=function(e){if(e&&l(e)){var r=null;if(Array.isArray(e)&&2===e.length)r=new a(e[1],e[0]);else{if(!t.isDefined(e.type)||"Point"!==e.type)return e;r=new a(e.coordinates[1],e.coordinates[0])}return angular.extend(e,r)}};return{getLat:o,getLng:i,validateCoords:l,getCoords:s}}]),angular.module("leaflet-directive").service("leafletHelpers",["$q","$log",function(e,r){function t(e,t){var n,o;if(angular.isDefined(t))n=t;else if(0===Object.keys(e).length)n="main";else if(Object.keys(e).length>=1)for(o in e)e.hasOwnProperty(o)&&(n=o);else r.error(a+"- You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call");return n}function n(r,n){var a,o=t(r,n);return angular.isDefined(r[o])&&r[o].resolvedDefer!==!0?a=r[o].defer:(a=e.defer(),r[o]={defer:a,resolvedDefer:!1}),a}var a="[AngularJS - Leaflet] ",o=angular.copy,i=o,l=function(e,r){var t;if(e&&angular.isObject(e))return null!==r&&angular.isString(r)?(t=e,r.split(".").forEach(function(e){t&&(t=t[e])}),t):r},s=function(e){return e.split(".").reduce(function(e,r){return e+'["'+r+'"]'})},u=function(e){return e.reduce(function(e,r){return e+"."+r})},c=function(e){return angular.isDefined(e)&&null!==e},d=function(e){return!c(e)},f=/([\:\-\_]+(.))/g,p=/^moz([A-Z])/,g=/^((?:x|data)[\:\-_])/i,v=function(e){return e.replace(f,function(e,r,t,n){return n?t.toUpperCase():t}).replace(p,"Moz$1")},y=function(e){return v(e.replace(g,""))};return{camelCase:v,directiveNormalize:y,copy:o,clone:i,errorHeader:a,getObjectValue:l,getObjectArrayPath:s,getObjectDotPath:u,defaultTo:function(e,r){return c(e)?e:r},isTruthy:function(e){return"true"===e||e===!0},isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:c,isUndefined:d,isNumber:angular.isNumber,isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isFunction:angular.isFunction,equals:angular.equals,isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return angular.isDefined(e)?angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng):!1},isSameCenterOnMap:function(e,r){var t=r.getCenter(),n=r.getZoom();return e.lat&&e.lng&&t.lat.toFixed(4)===e.lat.toFixed(4)&&t.lng.toFixed(4)===e.lng.toFixed(4)&&n===e.zoom?!0:!1},safeApply:function(e,r){var t=e.$root.$$phase;"$apply"===t||"$digest"===t?e.$eval(r):e.$evalAsync(r)},obtainEffectiveMapId:t,getDefer:function(e,r){var a,o=t(e,r);return a=angular.isDefined(e[o])&&e[o].resolvedDefer!==!1?e[o].defer:n(e,r)},getUnresolvedDefer:n,setResolvedDefer:function(e,r){var n=t(e,r);e[n].resolvedDefer=!0},rangeIsSupported:function(){var e=document.createElement("input");return e.setAttribute("type","range"),"range"===e.type},FullScreenControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.Fullscreen)}},MiniMapControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.MiniMap)}},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)},is:function(e){return this.isLoaded()?e instanceof L.AwesomeMarkers.Icon:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},VectorMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.VectorMarkers)&&angular.isDefined(L.VectorMarkers.Icon)},is:function(e){return this.isLoaded()?e instanceof L.VectorMarkers.Icon:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},DomMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.DomMarkers)&&angular.isDefined(L.DomMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.DomMarkers.Icon:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},PolylineDecoratorPlugin:{isLoaded:function(){return angular.isDefined(L.PolylineDecorator)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.PolylineDecorator:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},MakiMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.MakiMarkers)&&angular.isDefined(L.MakiMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.MakiMarkers.Icon:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},ExtraMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.ExtraMarkers)&&angular.isDefined(L.ExtraMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.ExtraMarkers.Icon:!1},equal:function(e,r){return this.isLoaded()&&this.is(e)?angular.equals(e,r):!1}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return this.isLoaded()?e instanceof L.Google:!1}},LeafletProviderPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.Provider)},is:function(e){return this.isLoaded()?e instanceof L.TileLayer.Provider:!1}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatLayerPlugin:{isLoaded:function(){return angular.isDefined(L.heatLayer)}},WebGLHeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return this.isLoaded()?e instanceof L.BingLayer:!1}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return this.isLoaded()?e instanceof L.GeoJSON.WFS:!1}},AGSBaseLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.basemapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.basemapLayer:!1}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return this.isLoaded()?e instanceof lvector.AGS:!1}},AGSFeatureLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.featureLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.featureLayer:!1}},AGSTiledMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.tiledMapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.tiledMapLayer:!1}},AGSDynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.dynamicMapLayer:!1}},AGSImageMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.imageMapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.imageMapLayer:!1}},AGSClusteredLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.clusteredFeatureLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.clusteredFeatureLayer:!1}},AGSHeatmapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.heatmapFeatureLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.heatmapFeatureLayer:!1}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return this.isLoaded()?e instanceof L.Yandex:!1}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return this.isLoaded()?e instanceof L.TileLayer.GeoJSON:!1}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(r.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,r){return this.is(e)?angular.equals(e,r):!1}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,r){return this.is(e)?angular.equals(e,r):!1}}},watchOptions:{doWatch:!0,isDeep:!0,individual:{doWatch:!0,isDeep:!0}}}}]),angular.module("leaflet-directive").service("leafletIterators",["$log","leafletHelpers",function(e,r){var t,n=r,a=r.errorHeader+"leafletIterators: ",o=Object.keys,i=n.isFunction,l=n.isObject,s=Math.pow(2,53)-1,u=function(e){var r=null!==e&&e.length;return n.isNumber(r)&&r>=0&&s>=r},c=function(e){return e},d=function(e){return function(r){return null===r?void 0:r[e]}},f=function(e,r,t){if(void 0===r)return e;switch(null===t?3:t){case 1:return function(t){return e.call(r,t)};case 2:return function(t,n){return e.call(r,t,n)};case 3:return function(t,n,a){return e.call(r,t,n,a)};case 4:return function(t,n,a,o){return e.call(r,t,n,a,o)}}return function(){return e.apply(r,arguments)}},p=function(e,r){return function(t){var n=arguments.length;if(2>n||null===t)return t;for(var a=1;n>a;a++)for(var o=arguments[a],i=e(o),l=i.length,s=0;l>s;s++){var u=i[s];r&&void 0!==t[u]||(t[u]=o[u])}return t}},g=null;t=g=p(o);var v,y=function(e,r){var t=o(r),n=t.length;if(null===e)return!n;for(var a=Object(e),i=0;n>i;i++){var l=t[i];if(r[l]!==a[l]||!(l in a))return!1}return!0},m=null;v=m=function(e){return e=t({},e),function(r){return y(r,e)}};var h,L=function(e,r,t){return null===e?c:i(e)?f(e,r,t):l(e)?v(e):d(e)},b=null;h=b=function(e,r,t){r=L(r,t);for(var n=!u(e)&&o(e),a=(n||e).length,i=0;a>i;i++){var l=n?n[i]:i;if(!r(e[l],l,e))return!1}return!0};var w=function(r,t,o,i){return o||n.isDefined(r)&&n.isDefined(t)?n.isFunction(t)?!1:(i=n.defaultTo(t,"cb"),e.error(a+i+" is not a function"),!0):!0},k=function(e,r,t){if(!w(void 0,t,!0,"internalCb")&&!w(e,r))for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},C=function(e,r){k(e,r,function(e,t){r(e,t)})};return{each:C,forEach:C,every:h,all:b}}]),angular.module("leaflet-directive").factory("leafletLayerHelpers",["$rootScope","$log","$q","leafletHelpers","leafletIterators",function($rootScope,$log,$q,leafletHelpers,leafletIterators){function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):layerTypes[e.type].mustHaveKey&&!isDefined(e.key)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):!0:($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(!isString(e.name))return void $log.error("[AngularJS - Leaflet] A base layer must have a name");isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={});for(var r in e.layerParams)e.layerOptions[r]=e.layerParams[r];var t={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,icon:e.icon,type:e.layerType,bounds:e.bounds,key:e.key,apiKey:e.apiKey,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(t)}}function safeAddLayer(e,r){r&&"function"==typeof r.addTo?r.addTo(e):e.addLayer(r)}function safeRemoveLayer(e,r,t){if(isDefined(t)&&isDefined(t.loadedDefer))if(angular.isFunction(t.loadedDefer)){var n=t.loadedDefer();$log.debug("Loaded Deferred",n);var a=n.length;if(a>0)for(var o=function(){a--,0===a&&e.removeLayer(r)},i=0;i<n.length;i++)n[i].promise.then(o);else e.removeLayer(r)}else t.loadedDefer.promise.then(function(){e.removeLayer(r)});else e.removeLayer(r)}var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isArray=leafletHelpers.isArray,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,$it=leafletIterators,utfGridCreateLayer=function(e){if(!Helpers.UTFGridPlugin.isLoaded())return void $log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.");var r=new L.UtfGrid(e.url,e.pluginOptions);return r.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),r.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),r.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),r.on("mousemove",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)}),r},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var r=3;isDefined(e.options.version)&&4===e.options.version&&(r=e.options.version);var t=3===r?"//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png":"//api.tiles.mapbox.com/v4/"+e.key+"/{z}/{x}/{y}.png?access_token="+e.apiKey;return L.tileLayer(t,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){return Helpers.GeoJSONPlugin.isLoaded()?new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options):void 0}},geoJSONShape:{mustHaveUrl:!1,createLayer:function(e){return new L.GeoJSON(e.data,e.options)}},geoJSONAwesomeMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(r,t){return L.marker(t,{icon:L.AwesomeMarkers.icon(e.icon)})}})}},geoJSONVectorMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(r,t){return L.marker(t,{icon:L.VectorMarkers.icon(e.icon)})}})}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var r="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(r,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var r="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",t=L.tileLayer(r,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var n=utfGridCreateLayer(e);return L.layerGroup([t,n])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var r=[];return $it.each(e.options.layers,function(e){r.push(createLayer(e))}),e.options.loadedDefer=function(){var r=[];if(isDefined(e.options.layers))for(var t=0;t<e.options.layers.length;t++){var n=e.options.layers[t].layerOptions.loadedDefer;isDefined(n)&&r.push(n)}return r},L.layerGroup(r)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(r,e.options)}},here:{mustHaveUrl:!1,createLayer:function(e){var r=e.provider||"HERE.terrainDay";if(Helpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(r,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(r,e.options)}},agsBase:{mustHaveLayer:!0,createLayer:function(e){return Helpers.AGSBaseLayerPlugin.isLoaded()?L.esri.basemapLayer(e.layer,e.options):void 0}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var r=angular.copy(e.options);angular.extend(r,{url:e.url});var t=new lvector.AGS(r);return t.onAdd=function(e){this.setMap(e)},t.onRemove=function(){this.setMap(null)},t}}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(!Helpers.AGSFeatureLayerPlugin.isLoaded())return void $log.warn(errorHeader+" The esri plugin is not loaded.");e.options.url=e.url;var r=L.esri.featureLayer(e.options),t=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return r.on("loading",function(){e.options.loadedDefer=$q.defer(),r.off("load",t),
r.on("load",t)}),r}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSTiledMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.tiledMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSDynamicMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.dynamicMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSImageMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.imageMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSClusteredLayerPlugin.isLoaded()?Helpers.MarkerClusterPlugin.isLoaded()?L.esri.clusteredFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded."):void $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSHeatmapLayerPlugin.isLoaded()?Helpers.HeatLayerPlugin.isLoaded()?L.esri.heatmapFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The heatlayer plugin is not loaded."):void $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},markercluster:{mustHaveUrl:!1,createLayer:function(e){return Helpers.MarkerClusterPlugin.isLoaded()?new L.MarkerClusterGroup(e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){return Helpers.BingLayerPlugin.isLoaded()?new L.BingLayer(e.key,e.options):void 0}},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.WebGLHeatMapLayerPlugin.isLoaded()){var r=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&r.setData(e.data),r}}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatLayerPlugin.isLoaded()){var r=new L.heatLayer;return isArray(e.data)&&r.setLatLngs(e.data),isObject(e.options)&&r.setOptions(e.options),r}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(r,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},iip:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.iip(e.url,e.options)}},custom:{createLayer:function(e){return e.layer instanceof L.Class?angular.copy(e.layer):void $log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};return{createLayer:createLayer,safeAddLayer:safeAddLayer,safeRemoveLayer:safeRemoveLayer}}]),angular.module("leaflet-directive").factory("leafletLegendHelpers",function(){var e=function(e,r,t,n){if(e.innerHTML="",r.error)e.innerHTML+='<div class="info-title alert alert-danger">'+r.error.message+"</div>";else if("arcgis"===t)for(var a=0;a<r.layers.length;a++){var o=r.layers[a];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var i=0;i<o.legend.length;i++){var l=o.legend[i];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+l.contentType+";base64,"+l.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+l.label+"</div>"}}else"image"===t&&(e.innerHTML='<img src="'+n+'"/>')},r=function(r,t,n,a){return function(){var o=L.DomUtil.create("div",t);return L.Browser.touch?L.DomEvent.on(o,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation)),e(o,r,n,a),o}},t=function(e,r){return function(){for(var t=L.DomUtil.create("div",r),n=0;n<e.colors.length;n++)t.innerHTML+='<div class="outline"><i style="background:'+e.colors[n]+'"></i></div><div class="info-label">'+e.labels[n]+"</div>";return L.Browser.touch?L.DomEvent.on(t,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(t),L.DomEvent.on(t,"mousewheel",L.DomEvent.stopPropagation)),t}};return{getOnAddLegend:r,getOnAddArrayLegend:t,updateLegend:e}}),angular.module("leaflet-directive").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,r){function t(){return{keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},nominatim:{server:" http://nominatim.openstreetmap.org/search"},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var n=r.isDefined,a=r.isObject,o=r.obtainEffectiveMapId,i={};return{reset:function(){i={}},getDefaults:function(e){var r=o(i,e);return i[r]},getMapCreationDefaults:function(e){var r=o(i,e),t=i[r],a={maxZoom:t.maxZoom,keyboard:t.keyboard,dragging:t.dragging,zoomControl:t.zoomControl,doubleClickZoom:t.doubleClickZoom,scrollWheelZoom:t.scrollWheelZoom,tap:t.tap,touchZoom:t.touchZoom,attributionControl:t.attributionControl,worldCopyJump:t.worldCopyJump,crs:t.crs};if(n(t.minZoom)&&(a.minZoom=t.minZoom),n(t.zoomAnimation)&&(a.zoomAnimation=t.zoomAnimation),n(t.fadeAnimation)&&(a.fadeAnimation=t.fadeAnimation),n(t.markerZoomAnimation)&&(a.markerZoomAnimation=t.markerZoomAnimation),t.map)for(var l in t.map)a[l]=t.map[l];return a},setDefaults:function(e,r){var l=t();n(e)&&(l.doubleClickZoom=n(e.doubleClickZoom)?e.doubleClickZoom:l.doubleClickZoom,l.scrollWheelZoom=n(e.scrollWheelZoom)?e.scrollWheelZoom:l.doubleClickZoom,l.tap=n(e.tap)?e.tap:l.tap,l.touchZoom=n(e.touchZoom)?e.touchZoom:l.doubleClickZoom,l.zoomControl=n(e.zoomControl)?e.zoomControl:l.zoomControl,l.zoomsliderControl=n(e.zoomsliderControl)?e.zoomsliderControl:l.zoomsliderControl,l.attributionControl=n(e.attributionControl)?e.attributionControl:l.attributionControl,l.tileLayer=n(e.tileLayer)?e.tileLayer:l.tileLayer,l.zoomControlPosition=n(e.zoomControlPosition)?e.zoomControlPosition:l.zoomControlPosition,l.keyboard=n(e.keyboard)?e.keyboard:l.keyboard,l.dragging=n(e.dragging)?e.dragging:l.dragging,n(e.controls)&&angular.extend(l.controls,e.controls),a(e.crs)?l.crs=e.crs:n(L.CRS[e.crs])&&(l.crs=L.CRS[e.crs]),n(e.center)&&angular.copy(e.center,l.center),n(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,l.tileLayerOptions),n(e.maxZoom)&&(l.maxZoom=e.maxZoom),n(e.minZoom)&&(l.minZoom=e.minZoom),n(e.zoomAnimation)&&(l.zoomAnimation=e.zoomAnimation),n(e.fadeAnimation)&&(l.fadeAnimation=e.fadeAnimation),n(e.markerZoomAnimation)&&(l.markerZoomAnimation=e.markerZoomAnimation),n(e.worldCopyJump)&&(l.worldCopyJump=e.worldCopyJump),n(e.map)&&(l.map=e.map),n(e.path)&&(l.path=e.path));var s=o(i,r);return i[s]=l,l}}}]),angular.module("leaflet-directive").service("leafletMarkersHelpers",["$rootScope","$timeout","leafletHelpers","$log","$compile","leafletGeoJsonHelpers",function(e,r,t,n,a,o){var i=t.isDefined,l=t.defaultTo,s=t.MarkerClusterPlugin,u=t.AwesomeMarkersPlugin,c=t.VectorMarkersPlugin,d=t.MakiMarkersPlugin,f=t.ExtraMarkersPlugin,p=t.DomMarkersPlugin,g=t.safeApply,v=t,y=t.isString,m=t.isNumber,h=t.isObject,b={},w=o,k=t.errorHeader,C=function(e){var r="";return["_icon","_latlng","_leaflet_id","_map","_shadow"].forEach(function(t){r+=t+": "+l(e[t],"undefined")+" \n"}),"[leafletMarker] : \n"+r},A=function(e,r){var t=r?console:n;t.debug(C(e))},D=function(r){if(i(r)&&i(r.type)&&"awesomeMarker"===r.type)return u.isLoaded()||n.error(k+" The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(r);if(i(r)&&i(r.type)&&"vectorMarker"===r.type)return c.isLoaded()||n.error(k+" The VectorMarkers Plugin is not loaded."),new L.VectorMarkers.icon(r);if(i(r)&&i(r.type)&&"makiMarker"===r.type)return d.isLoaded()||n.error(k+"The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(r);if(i(r)&&i(r.type)&&"extraMarker"===r.type)return f.isLoaded()||n.error(k+"The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(r);if(i(r)&&i(r.type)&&"div"===r.type)return new L.divIcon(r);if(i(r)&&i(r.type)&&"dom"===r.type){p.isLoaded()||n.error(k+"The DomMarkers Plugin is not loaded.");var t=angular.isFunction(r.getMarkerScope)?r.getMarkerScope():e,o=a(r.template)(t),l=angular.copy(r);return l.element=o[0],new L.DomMarkers.icon(l)}if(i(r)&&i(r.type)&&"icon"===r.type)return r.icon;var s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=";return i(r)&&i(r.iconUrl)?new L.Icon(r):new L.Icon.Default({iconUrl:s,shadowUrl:g,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},S=function(e){i(b[e])&&b.splice(e,1)},P=function(){b={}},H=function(e,r,t){if(e.closePopup(),i(t)&&i(t.overlays))for(var n in t.overlays)if((t.overlays[n]instanceof L.LayerGroup||t.overlays[n]instanceof L.FeatureGroup)&&t.overlays[n].hasLayer(e))return void t.overlays[n].removeLayer(e);if(i(b))for(var a in b)b[a].hasLayer(e)&&b[a].removeLayer(e);r.hasLayer(e)&&r.removeLayer(e)},M=function(e,r){var t=e._popup._container.offsetHeight,n=new L.Point(e._popup._containerLeft,-t-e._popup._containerBottom),a=r.layerPointToContainerPoint(n);null!==a&&e._popup._adjustPan()},O=function(e,r){a(e._popup._contentNode)(r)},x=function(e,t,n){var a=e._popup._contentNode.innerText||e._popup._contentNode.textContent;a.length<1&&r(function(){x(e,t,n)});var o=e._popup._contentNode.offsetWidth;return e._popup._updateLayout(),e._popup._updatePosition(),e._popup.options.autoPan&&M(e,n),o},E=function(r,t,a){var o=angular.isFunction(t.getMessageScope)?t.getMessageScope():e,l=i(t.compileMessage)?t.compileMessage:!0;if(l){if(!i(r._popup)||!i(r._popup._contentNode))return n.error(k+"Popup is invalid or does not have any content."),!1;O(r,o),x(r,t,a)}},$=function(r,t){var n=angular.isFunction(t.getMessageScope)?t.getMessageScope():e,o=angular.isFunction(t.getLabelScope)?t.getLabelScope():n,l=i(t.compileMessage)?t.compileMessage:!0;v.LabelPlugin.isLoaded()&&i(t.label)&&(i(t.label.options)&&t.label.options.noHide===!0&&r.showLabel(),l&&i(r.label)&&a(r.label._container)(o))},T=function(e,r,t,a,o,l,s){if(i(r)){if(!w.validateCoords(e))return n.warn("There are problems with lat-lng data, please verify your marker model"),void H(t,s,l);var u=e===r;if(i(e.iconAngle)&&r.iconAngle!==e.iconAngle&&t.setIconAngle(e.iconAngle),y(e.layer)||y(r.layer)&&(i(l.overlays[r.layer])&&l.overlays[r.layer].hasLayer(t)&&(l.overlays[r.layer].removeLayer(t),t.closePopup()),s.hasLayer(t)||s.addLayer(t)),(m(e.opacity)||m(parseFloat(e.opacity)))&&e.opacity!==r.opacity&&t.setOpacity(e.opacity),y(e.layer)&&r.layer!==e.layer){if(y(r.layer)&&i(l.overlays[r.layer])&&l.overlays[r.layer].hasLayer(t)&&l.overlays[r.layer].removeLayer(t),t.closePopup(),s.hasLayer(t)&&s.removeLayer(t),!i(l.overlays[e.layer]))return void n.error(k+"You must use a name of an existing layer");var c=l.overlays[e.layer];if(!(c instanceof L.LayerGroup||c instanceof L.FeatureGroup))return void n.error(k+'A marker can only be added to a layer of type "group" or "featureGroup"');c.addLayer(t),s.hasLayer(t)&&e.focus===!0&&t.openPopup()}if(e.draggable!==!0&&r.draggable===!0&&i(t.dragging)&&t.dragging.disable(),e.draggable===!0&&r.draggable!==!0&&(t.dragging?t.dragging.enable():L.Handler.MarkerDrag&&(t.dragging=new L.Handler.MarkerDrag(t),t.options.draggable=!0,t.dragging.enable())),h(e.icon)||h(r.icon)&&(t.setIcon(D()),t.closePopup(),t.unbindPopup(),y(e.message)&&t.bindPopup(e.message,e.popupOptions)),h(e.icon)&&h(r.icon)&&!angular.equals(e.icon,r.icon)){var d=!1;t.dragging&&(d=t.dragging.enabled()),t.setIcon(D(e.icon)),d&&t.dragging.enable(),t.closePopup(),t.unbindPopup(),y(e.message)&&(t.bindPopup(e.message,e.popupOptions),s.hasLayer(t)&&e.focus===!0&&t.openPopup())}!y(e.message)&&y(r.message)&&(t.closePopup(),t.unbindPopup()),v.LabelPlugin.isLoaded()&&(i(e.label)&&i(e.label.message)?"label"in r&&"message"in r.label&&!angular.equals(e.label.message,r.label.message)?t.updateLabelContent(e.label.message):!angular.isFunction(t.getLabel)||angular.isFunction(t.getLabel)&&!i(t.getLabel())?(t.bindLabel(e.label.message,e.label.options),$(t,e)):$(t,e):(!("label"in e)||"message"in e.label)&&angular.isFunction(t.unbindLabel)&&t.unbindLabel()),y(e.message)&&!y(r.message)&&t.bindPopup(e.message,e.popupOptions),y(e.message)&&y(r.message)&&e.message!==r.message&&t.setPopupContent(e.message);var f=!1;e.focus!==!0&&r.focus===!0&&(t.closePopup(),f=!0),(e.focus===!0&&(!i(r.focus)||r.focus===!1)||u&&e.focus===!0)&&(t.openPopup(),f=!0),r.zIndexOffset!==e.zIndexOffset&&t.setZIndexOffset(e.zIndexOffset);var p=t.getLatLng(),g=y(e.layer)&&v.MarkerClusterPlugin.is(l.overlays[e.layer]);g?f?(e.lat!==r.lat||e.lng!==r.lng)&&(l.overlays[e.layer].removeLayer(t),t.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(t)):p.lat!==e.lat||p.lng!==e.lng?(l.overlays[e.layer].removeLayer(t),t.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(t)):e.lat!==r.lat||e.lng!==r.lng?(l.overlays[e.layer].removeLayer(t),t.setLatLng([e.lat,e.lng]),l.overlays[e.layer].addLayer(t)):h(e.icon)&&h(r.icon)&&!angular.equals(e.icon,r.icon)&&(l.overlays[e.layer].removeLayer(t),l.overlays[e.layer].addLayer(t)):(p.lat!==e.lat||p.lng!==e.lng)&&t.setLatLng([e.lat,e.lng])}};return{resetMarkerGroup:S,resetMarkerGroups:P,deleteMarker:H,manageOpenPopup:E,manageOpenLabel:$,createMarker:function(e){if(!i(e)||!w.validateCoords(e))return void n.error(k+"The marker definition is not valid.");var r=w.getCoords(e);if(!i(r))return void n.error(k+"Unable to get coordinates from markerData.");var t={icon:D(e.icon),title:i(e.title)?e.title:"",draggable:i(e.draggable)?e.draggable:!1,clickable:i(e.clickable)?e.clickable:!0,riseOnHover:i(e.riseOnHover)?e.riseOnHover:!1,zIndexOffset:i(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:i(e.iconAngle)?e.iconAngle:0};for(var a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);var o=new L.marker(r,t);return y(e.message)||o.unbindPopup(),o},addMarkerToGroup:function(e,r,t,a){return y(r)?s.isLoaded()?(i(b[r])||(b[r]=new L.MarkerClusterGroup(t),a.addLayer(b[r])),void b[r].addLayer(e)):void n.error(k+"The MarkerCluster plugin is not loaded."):void n.error(k+"The marker group you have specified is invalid.")},listenMarkerEvents:function(e,r,t,n,a){e.on("popupopen",function(){g(t,function(){(i(e._popup)||i(e._popup._contentNode))&&(r.focus=!0,E(e,r,a))})}),e.on("popupclose",function(){g(t,function(){r.focus=!1})}),e.on("add",function(){g(t,function(){"label"in r&&$(e,r)})})},updateMarker:T,addMarkerWatcher:function(e,r,t,n,a,o){var s=v.getObjectArrayPath("markers."+r);o=l(o,!0);var u=t.$watch(s,function(o,l){return i(o)?void T(o,l,e,r,t,n,a):(H(e,a,n),void u())},o)},string:C,log:A}}]),angular.module("leaflet-directive").factory("leafletPathsHelpers",["$rootScope","$log","leafletHelpers",function(e,r,t){function n(e){return e.filter(function(e){return c(e)}).map(function(e){return a(e)})}function a(e){return s(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function o(e){return e.map(function(e){return n(e)})}function i(e,r){for(var t={},n=0;n<d.length;n++){var a=d[n];l(e[a])?t[a]=e[a]:l(r.path[a])&&(t[a]=r.path[a])}return t}var l=t.isDefined,s=t.isArray,u=t.isNumber,c=t.isValidPoint,d=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"],f=function(e,r){for(var t={},n=0;n<d.length;n++){var a=d[n];l(r[a])&&(t[a]=r[a])}e.setStyle(r)},p=function(e){if(!s(e))return!1;for(var r=0;r<e.length;r++){var t=e[r];if(!c(t))return!1}return!0},g={polyline:{isValid:function(e){var r=e.latlngs;return p(r)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,r){e.setLatLngs(n(r.latlngs)),f(e,r)}},multiPolyline:{isValid:function(e){var r=e.latlngs;if(!s(r))return!1;for(var t in r){var n=r[t];if(!p(n))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,r){e.setLatLngs(o(r.latlngs)),f(e,r)}},polygon:{isValid:function(e){var r=e.latlngs;return p(r)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,r){e.setLatLngs(n(r.latlngs)),f(e,r)}},multiPolygon:{isValid:function(e){var r=e.latlngs;if(!s(r))return!1;for(var t in r){var n=r[t];if(!p(n))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,r){e.setLatLngs(o(r.latlngs)),f(e,r)}},rectangle:{isValid:function(e){var r=e.latlngs;if(!s(r)||2!==r.length)return!1;for(var t in r){var n=r[t];if(!c(n))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,r){e.setBounds(new L.LatLngBounds(n(r.latlngs))),f(e,r)}},circle:{isValid:function(e){var r=e.latlngs;return c(r)&&u(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,r){e.setLatLng(a(r.latlngs)),l(r.radius)&&e.setRadius(r.radius),f(e,r)}},circleMarker:{isValid:function(e){var r=e.latlngs;return c(r)&&u(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,r){e.setLatLng(a(r.latlngs)),l(r.radius)&&e.setRadius(r.radius),f(e,r)}}},v=function(e){var r={};return e.latlngs&&(r.latlngs=e.latlngs),e.radius&&(r.radius=e.radius),r};return{setPathOptions:function(e,r,t){l(r)||(r="polyline"),g[r].setPath(e,t)},createPath:function(e,t,n){l(t.type)||(t.type="polyline");var a=i(t,n),o=v(t);return g[t.type].isValid(o)?g[t.type].createPath(a):void r.error("[AngularJS - Leaflet] Invalid data passed to the "+t.type+" path")}}}]),angular.module("leaflet-directive").service("leafletWatchHelpers",function(){var e=function(e,r,t,n,a){var o=e[r](t,function(e,r){a(e,r),n.doWatch||o()},n.isDeep);return o},r=function(r,t,n,a){return e(r,"$watch",t,n,a)},t=function(r,t,n,a){return e(r,"$watchCollection",t,n,a)};return{maybeWatch:r,maybeWatchCollection:t}}),angular.module("leaflet-directive").factory("nominatimService",["$q","$http","leafletHelpers","leafletMapDefaults",function(e,r,t,n){var a=t.isDefined;return{query:function(t,o){var i=n.getDefaults(o),l=i.nominatim.server,s=e.defer();return r.get(l,{params:{format:"json",limit:1,q:t}}).success(function(e){e.length>0&&a(e[0].boundingbox)?s.resolve(e[0]):s.reject("[Nominatim] Invalid address")}),s.promise}}}]),angular.module("leaflet-directive").directive("bounds",["$log","$timeout","$http","leafletHelpers","nominatimService","leafletBoundsHelpers",function(e,r,t,n,a,o){return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(t,i,l,s){var u=n.isDefined,c=o.createLeafletBounds,d=s[0].getLeafletScope(),f=s[0],p=n.errorHeader+" [Bounds] ",g=function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng};f.getMap().then(function(n){d.$on("boundsChanged",function(e){var t=e.currentScope,a=n.getBounds();if(!g(a)&&!t.settingBoundsFromScope){t.settingBoundsFromLeaflet=!0;var o={northEast:{lat:a._northEast.lat,lng:a._northEast.lng},southWest:{lat:a._southWest.lat,lng:a._southWest.lng},options:a.options};angular.equals(t.bounds,o)||(t.bounds=o),r(function(){t.settingBoundsFromLeaflet=!1})}});var o;d.$watch("bounds",function(i){if(!t.settingBoundsFromLeaflet){if(u(i.address)&&i.address!==o)return t.settingBoundsFromScope=!0,a.query(i.address,l.id).then(function(e){var r=e.boundingbox,t=[[r[0],r[2]],[r[1],r[3]]];n.fitBounds(t)},function(r){e.error(p+" "+r+".")}),o=i.address,void r(function(){t.settingBoundsFromScope=!1});var s=c(i);s&&!n.getBounds().equals(s)&&(t.settingBoundsFromScope=!0,n.fitBounds(s,i.options),r(function(){t.settingBoundsFromScope=!1}))}},!0)})}}}]);var centerDirectiveTypes=["center","lfCenter"],centerDirectives={};centerDirectiveTypes.forEach(function(e){centerDirectives[e]=["$log","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletMapEvents",function(r,t,n,a,o,i,l,s){var u,c=i.isDefined,d=i.isNumber,f=i.isSameCenterOnMap,p=i.safeApply,g=i.isValidCenter,v=l.isValidBounds,y=i.isUndefinedOrEmpty,m=i.errorHeader,h=function(e,r){return c(e)&&v(e)&&y(r)};return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){u=t.defer(),this.getCenter=function(){return u.promise}},link:function(t,i,v,y){var L=y.getLeafletScope(),b=L[e];y.getMap().then(function(t){var i=o.getDefaults(v.id);if(-1!==v[e].search("-"))return r.error(m+' The "center" variable can\'t use a "-" on its key name: "'+v[e]+'".'),void t.setView([i.center.lat,i.center.lng],i.center.zoom);if(h(L.bounds,b))t.fitBounds(l.createLeafletBounds(L.bounds),L.bounds.options),b=t.getCenter(),p(L,function(r){angular.extend(r[e],{lat:t.getCenter().lat,lng:t.getCenter().lng,zoom:t.getZoom(),autoDiscover:!1})}),p(L,function(e){var r=t.getBounds();e.bounds={northEast:{lat:r._northEast.lat,lng:r._northEast.lng},southWest:{lat:r._southWest.lat,lng:r._southWest.lng}}});else{if(!c(b))return r.error(m+' The "center" property is not defined in the main scope'),void t.setView([i.center.lat,i.center.lng],i.center.zoom);c(b.lat)&&c(b.lng)||c(b.autoDiscover)||angular.copy(i.center,b)}var y,w;if("yes"===v.urlHashCenter){var k=function(){var e,r=n.search();if(c(r.c)){var t=r.c.split(":");3===t.length&&(e={lat:parseFloat(t[0]),lng:parseFloat(t[1]),zoom:parseInt(t[2],10)})}return e};y=k(),L.$on("$locationChangeSuccess",function(r){var n=r.currentScope,a=k();c(a)&&!f(a,t)&&angular.extend(n[e],{lat:a.lat,lng:a.lng,zoom:a.zoom})})}L.$watch(e,function(e){return L.settingCenterFromLeaflet?void 0:(c(y)&&(angular.copy(y,e),y=void 0),g(e)||e.autoDiscover===!0?e.autoDiscover===!0?(d(e.zoom)||t.setView([i.center.lat,i.center.lng],i.center.zoom),void(d(e.zoom)&&e.zoom>i.center.zoom?t.locate({setView:!0,maxZoom:e.zoom}):c(i.maxZoom)?t.locate({setView:!0,maxZoom:i.maxZoom}):t.locate({setView:!0}))):void(w&&f(e,t)||(L.settingCenterFromScope=!0,t.setView([e.lat,e.lng],e.zoom),s.notifyCenterChangedToBounds(L,t),a(function(){L.settingCenterFromScope=!1}))):void r.warn(m+" invalid 'center'"))},!0),t.whenReady(function(){w=!0}),t.on("moveend",function(){u.resolve(),s.notifyCenterUrlHashChanged(L,t,v,n.search()),f(b,t)||L.settingCenterFromScope||(L.settingCenterFromLeaflet=!0,p(L,function(r){L.settingCenterFromScope||angular.extend(r[e],{lat:t.getCenter().lat,lng:t.getCenter().lng,zoom:t.getZoom(),autoDiscover:!1}),s.notifyCenterChangedToBounds(L,t),a(function(){L.settingCenterFromLeaflet=!1})}))}),b.autoDiscover===!0&&t.on("locationerror",function(){r.warn(m+" The Geolocation API is unauthorized on this page."),g(b)?(t.setView([b.lat,b.lng],b.zoom),s.notifyCenterChangedToBounds(L,t)):(t.setView([i.center.lat,i.center.lng],i.center.zoom),s.notifyCenterChangedToBounds(L,t))})})}}}]}),centerDirectiveTypes.forEach(function(e){angular.module("leaflet-directive").directive(e,centerDirectives[e])}),angular.module("leaflet-directive").directive("controls",["$log","leafletHelpers","leafletControlHelpers",function(e,r,t){return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(n,a,o,i){if(i){var l=t.createControl,s=t.isValidControlType,u=i.getLeafletScope(),c=r.isDefined,d=r.isArray,f={},p=r.errorHeader+" [Controls] ";i.getMap().then(function(r){u.$watchCollection("controls",function(t){for(var n in f)c(t[n])||(r.hasControl(f[n])&&r.removeControl(f[n]),delete f[n]);for(var a in t){var o,i=c(t[a].type)?t[a].type:a;if(!s(i))return void e.error(p+" Invalid control type: "+i+".");if("custom"!==i)o=l(i,t[a]),r.addControl(o),f[a]=o;else{var u=t[a];if(d(u))for(var g in u){var v=u[g];r.addControl(v),f[a]=c(f[a])?f[a].concat([v]):[v]}else r.addControl(u),f[a]=u}}})})}}}}]),angular.module("leaflet-directive").directive("decorations",["$log","leafletHelpers",function(e,r){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(t,n,a,o){function i(r){return c(r)&&c(r.coordinates)&&(u.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(r.coordinates)}function l(e,r){return c(e)&&c(r)&&c(r.coordinates)&&c(r.patterns)?(e.setPaths(r.coordinates),e.setPatterns(r.patterns),e):void 0}var s=o.getLeafletScope(),u=r.PolylineDecoratorPlugin,c=r.isDefined,d={};o.getMap().then(function(e){s.$watch("decorations",function(r){for(var t in d)c(r[t])&&angular.equals(r[t],d)||(e.removeLayer(d[t]),delete d[t]);for(var n in r){var a=r[n],o=i(a);c(o)&&(d[n]=o,e.addLayer(o),l(o,a))}},!0)})}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope","leafletHelpers","leafletMapEvents","leafletIterators",function(e,r,t,n,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,o,i,l){var s=t.isObject,u=t.isDefined,c=l.getLeafletScope(),d=c.eventBroadcast,f=n.getAvailableMapEvents(),p=n.addEvents;l.getMap().then(function(r){var t=[],n="broadcast";u(d.map)?s(d.map)?("emit"!==d.map.logic&&"broadcast"!==d.map.logic?e.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):n=d.map.logic,s(d.map.enable)&&d.map.enable.length>=0?a.each(d.map.enable,function(e){-1===t.indexOf(e)&&-1!==f.indexOf(e)&&t.push(e)}):e.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.")):e.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model."):t=f,p(r,t,"eventName",c,n)})}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope","leafletData","leafletHelpers","leafletWatchHelpers","leafletDirectiveControlsHelpers","leafletIterators","leafletGeoJsonEvents",function(e,r,t,n,a,o,i,l){var s=a.maybeWatch,u=n.watchOptions,c=o.extend,d=n,f=i;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,a,o){var i=n.isDefined,p=o.getLeafletScope(),g={},v=!1;o.getMap().then(function(e){var r=p.geojsonWatchOptions||u,o=function(e,r){var t;return t=angular.isFunction(e.onEachFeature)?e.onEachFeature:function(t,o){n.LabelPlugin.isLoaded()&&i(t.properties.description)&&o.bindLabel(t.properties.description),l.bindEvents(a.id,o,null,t,p,r,{resetStyleOnMouseout:e.resetStyleOnMouseout,mapId:a.id})}},y=d.isDefined(a.geojsonNested)&&d.isTruthy(a.geojsonNested),m=function(){if(g){var r=function(r){i(r)&&e.hasLayer(r)&&e.removeLayer(r)};return y?void f.each(g,function(e){r(e)}):void r(g)}},h=function(r,n){var l=angular.copy(r);if(i(l)&&i(l.data)){var s=o(l,n);i(l.options)||(l.options={style:l.style,filter:l.filter,onEachFeature:s,pointToLayer:l.pointToLayer});var u=L.geoJson(l.data,l.options);n&&d.isString(n)?g[n]=u:g=u,u.addTo(e),v||(v=!0,t.setGeoJSON(g,a.id))}},b=function(e){if(m(),y){if(!e||!Object.keys(e).length)return;return void f.each(e,function(e,r){h(e,r)})}h(e)};c(a.id,"geojson",b,m),s(p,"geojson",r,function(e){b(e)})})}}}]),angular.module("leaflet-directive").directive("layercontrol",["$filter","$log","leafletData","leafletHelpers",function(e,r,t,n){return{restrict:"E",scope:{icons:"=?",autoHideOpacity:"=?",showGroups:"=?",title:"@",baseTitle:"@",overlaysTitle:"@"},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(e,a,o){r.debug("[Angular Directive - Layers] layers",e,a);var i=n.safeApply,l=n.isDefined;angular.extend(e,{baselayer:"",oldGroup:"",layerProperties:{},groupProperties:{},rangeIsSupported:n.rangeIsSupported(),changeBaseLayer:function(r,a){n.safeApply(e,function(n){n.baselayer=r,t.getMap().then(function(a){t.getLayers().then(function(t){if(!a.hasLayer(t.baselayers[r])){for(var o in n.layers.baselayers)n.layers.baselayers[o].icon=n.icons.unradio,a.hasLayer(t.baselayers[o])&&a.removeLayer(t.baselayers[o]);a.addLayer(t.baselayers[r]),n.layers.baselayers[r].icon=e.icons.radio}})})}),a.preventDefault()},moveLayer:function(r,t,n){var a=Object.keys(e.layers.baselayers).length;if(t>=1+a&&t<=e.overlaysArray.length+a){var o;for(var l in e.layers.overlays)if(e.layers.overlays[l].index===t){o=e.layers.overlays[l];break}o&&i(e,function(){o.index=r.index,r.index=t})}n.stopPropagation(),n.preventDefault()},initIndex:function(r,t){var n=Object.keys(e.layers.baselayers).length;r.index=l(r.index)?r.index:t+n+1},initGroup:function(r){e.groupProperties[r]=e.groupProperties[r]?e.groupProperties[r]:{}},toggleOpacity:function(r,t){if(t.visible){if(e.autoHideOpacity&&!e.layerProperties[t.name].opacityControl)for(var n in e.layerProperties)e.layerProperties[n].opacityControl=!1;e.layerProperties[t.name].opacityControl=!e.layerProperties[t.name].opacityControl}r.stopPropagation(),r.preventDefault()},
toggleLegend:function(r){e.layerProperties[r.name].showLegend=!e.layerProperties[r.name].showLegend},showLegend:function(r){return r.legend&&e.layerProperties[r.name].showLegend},unsafeHTML:function(e){return o.trustAsHtml(e)},getOpacityIcon:function(r){return r.visible&&e.layerProperties[r.name].opacityControl?e.icons.close:e.icons.open},getGroupIcon:function(r){return r.visible?e.icons.check:e.icons.uncheck},changeOpacity:function(r){var n=e.layerProperties[r.name].opacity;t.getMap().then(function(a){t.getLayers().then(function(t){var o;for(var i in e.layers.overlays)if(e.layers.overlays[i]===r){o=t.overlays[i];break}a.hasLayer(o)&&(o.setOpacity&&o.setOpacity(n/100),o.getLayers&&o.eachLayer&&o.eachLayer(function(e){e.setOpacity&&e.setOpacity(n/100)}))})})},changeGroupVisibility:function(r){if(l(e.groupProperties[r])){var t=e.groupProperties[r].visible;for(var n in e.layers.overlays){var a=e.layers.overlays[n];a.group===r&&(a.visible=t)}}}});var s=a.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><h4 ng-if="title">{{ title }}</h4><div class="lf-baselayers"><h5 class="lf-title" ng-if="baseTitle">{{ baseTitle }}</h5><div class="lf-row" ng-repeat="(key, layer) in baselayersArray"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><h5 class="lf-title" ng-if="overlaysTitle">{{ overlaysTitle }}</h5><div class="lf-container"><div class="lf-row" ng-repeat="layer in (o = (overlaysArray | orderBy:\'index\':order))" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol-group" ng-if="showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-change="changeGroupVisibility(layer.group)" ng-model="groupProperties[layer.group].visible"/> <i class="lf-icon lf-icon-check" ng-class="getGroupIcon(groupProperties[layer.group])"></i><div class="lf-text">{{ layer.group }}</div></label><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-toggle-legend" ng-class="icons.toggleLegend" ng-if="layer.legend" ng-click="toggleLegend(layer)"></i> <i class="lf-icon lf-open" ng-class="getOpacityIcon(layer)" ng-click="toggleOpacity($event, layer)"></i></div><div class="lf-legend" ng-if="showLegend(layer)" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity clearfix" ng-if="layer.visible &amp;&amp; layerProperties[layer.name].opacityControl"><label ng-if="rangeIsSupported" class="pull-left" style="width: 50%">0</label><label ng-if="rangeIsSupported" class="pull-left text-right" style="width: 50%">100</label><input ng-if="rangeIsSupported" class="clearfix" type="range" min="0" max="100" class="lf-opacity-control" ng-model="layerProperties[layer.name].opacity" ng-change="changeOpacity(layer)"/><h6 ng-if="!rangeIsSupported">Range is not supported in this browser</h6></div></div></div></div></div>',link:function(e,r,a,o){var i=n.isDefined,l=o.getLeafletScope(),s=l.layers;e.$watch("icons",function(){var r={uncheck:"fa fa-square-o",check:"fa fa-check-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up",toggleLegend:"fa fa-pencil-square-o"};i(e.icons)?(angular.extend(r,e.icons),angular.extend(e.icons,r)):e.icons=r}),a.order=!i(a.order)||"normal"!==a.order&&"reverse"!==a.order?"normal":a.order,e.order="normal"===a.order,e.orderNumber="normal"===a.order?-1:1,e.layers=s,o.getMap().then(function(r){l.$watch("layers.baselayers",function(n){var a={};t.getLayers().then(function(t){var o;for(o in n){var i=n[o];i.icon=e.icons[r.hasLayer(t.baselayers[o])?"radio":"unradio"],a[o]=i}e.baselayersArray=a})}),l.$watch("layers.overlays",function(r){var n=[],a={};t.getLayers().then(function(t){var o;for(o in r){var l=r[o];l.icon=e.icons[l.visible?"check":"uncheck"],n.push(l),i(e.layerProperties[l.name])||(e.layerProperties[l.name]={opacity:i(l.layerOptions.opacity)?100*l.layerOptions.opacity:100,opacityControl:!1,showLegend:!0}),i(l.group)&&(i(e.groupProperties[l.group])||(e.groupProperties[l.group]={visible:!1}),a[l.group]=i(a[l.group])?a[l.group]:{count:0,visibles:0},a[l.group].count++,l.visible&&a[l.group].visibles++),i(l.index)&&t.overlays[o].setZIndex&&t.overlays[o].setZIndex(r[o].index)}for(o in a)e.groupProperties[o].visible=a[o].visibles===a[o].count;e.overlaysArray=n})},!0)})}}}]),angular.module("leaflet-directive").directive("layers",["$log","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,r,t,n,a,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=r.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,r,i,l){var s=n.isDefined,u={},c=l.getLeafletScope(),d=c.layers,f=a.createLayer,p=a.safeAddLayer,g=a.safeRemoveLayer,v=o.updateLayersControl,y=!1;l.getMap().then(function(r){e._leafletLayers.resolve(u),t.setLayers(u,i.id),u.baselayers={},u.overlays={};var n=i.id,a=!1;for(var o in d.baselayers){var l=f(d.baselayers[o]);s(l)?(u.baselayers[o]=l,d.baselayers[o].top===!0&&(p(r,u.baselayers[o]),a=!0)):delete d.baselayers[o]}!a&&Object.keys(u.baselayers).length>0&&p(r,u.baselayers[Object.keys(d.baselayers)[0]]);for(o in d.overlays){"cartodb"===d.overlays[o].type;var m=f(d.overlays[o]);s(m)?(u.overlays[o]=m,d.overlays[o].visible===!0&&p(r,u.overlays[o])):delete d.overlays[o]}c.$watch("layers.baselayers",function(e,t){if(angular.equals(e,t))return y=v(r,n,y,e,d.overlays,u),!0;for(var a in u.baselayers)(!s(e[a])||e[a].doRefresh)&&(r.hasLayer(u.baselayers[a])&&r.removeLayer(u.baselayers[a]),delete u.baselayers[a],e[a]&&e[a].doRefresh&&(e[a].doRefresh=!1));for(var o in e)if(s(u.baselayers[o]))e[o].top!==!0||r.hasLayer(u.baselayers[o])?e[o].top===!1&&r.hasLayer(u.baselayers[o])&&r.removeLayer(u.baselayers[o]):p(r,u.baselayers[o]);else{var i=f(e[o]);s(i)&&(u.baselayers[o]=i,e[o].top===!0&&p(r,u.baselayers[o]))}var l=!1;for(var c in u.baselayers)if(r.hasLayer(u.baselayers[c])){l=!0;break}!l&&Object.keys(u.baselayers).length>0&&p(r,u.baselayers[Object.keys(u.baselayers)[0]]),y=v(r,n,y,e,d.overlays,u)},!0),c.$watch("layers.overlays",function(e,t){if(angular.equals(e,t))return y=v(r,n,y,d.baselayers,e,u),!0;for(var a in u.overlays)if(!s(e[a])||e[a].doRefresh){if(r.hasLayer(u.overlays[a])){var o=s(e[a])?e[a].layerOptions:null;g(r,u.overlays[a],o)}delete u.overlays[a],e[a]&&e[a].doRefresh&&(e[a].doRefresh=!1)}for(var i in e){if(s(u.overlays[i]))e[i].visible&&!r.hasLayer(u.overlays[i])?p(r,u.overlays[i]):e[i].visible===!1&&r.hasLayer(u.overlays[i])&&g(r,u.overlays[i],e[i].layerOptions);else{var l=f(e[i]);if(!s(l))continue;u.overlays[i]=l,e[i].visible===!0&&p(r,u.overlays[i])}e[i].visible&&r._loaded&&e[i].data&&"heatmap"===e[i].type&&(u.overlays[i].setData(e[i].data),u.overlays[i].update())}y=v(r,n,y,d.baselayers,e,u)},!0)})}}}]),angular.module("leaflet-directive").directive("legend",["$log","$http","leafletHelpers","leafletLegendHelpers",function(e,r,t,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(a,o,i,l){var s,u,c,d,f=t.isArray,p=t.isDefined,g=t.isFunction,v=l.getLeafletScope(),y=v.legend;v.$watch("legend",function(e){p(e)&&(s=e.legendClass?e.legendClass:"legend",u=e.position||"bottomright",d=e.type||"arcgis")},!0),l.getMap().then(function(t){v.$watch("legend",function(r){return p(r)?p(r.url)||"arcgis"!==d||f(r.colors)&&f(r.labels)&&r.colors.length===r.labels.length?p(r.url)?void e.info("[AngularJS - Leaflet] loading legend service."):(p(c)&&(c.removeFrom(t),c=null),c=L.control({position:u}),"arcgis"===d&&(c.onAdd=n.getOnAddArrayLegend(r,s)),void c.addTo(t)):void e.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set."):void(p(c)&&(c.removeFrom(t),c=null))}),v.$watch("legend.url",function(a){p(a)&&r.get(a).success(function(e){p(c)?n.updateLegend(c.getContainer(),e,d,a):(c=L.control({position:u}),c.onAdd=n.getOnAddLegend(e,s,d,a),c.addTo(t)),p(y.loadedData)&&g(y.loadedData)&&y.loadedData()}).error(function(){e.warn("[AngularJS - Leaflet] legend.url not loaded.")})})})}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletMarkerEvents","leafletIterators","leafletWatchHelpers","leafletDirectiveControlsHelpers",function(e,r,t,n,a,o,i,l,s,u,c){var d=a.isDefined,f=a.errorHeader,p=a,g=a.isString,v=i.addMarkerWatcher,y=i.updateMarker,m=i.listenMarkerEvents,h=i.addMarkerToGroup,b=i.createMarker,w=i.deleteMarker,k=s,C=a.watchOptions,A=u.maybeWatch,D=c.extend,S=function(e,r,t){if(Object.keys(e).length){if(t&&g(t)){if(!e[t]||!Object.keys(e[t]).length)return;return e[t][r]}return e[r]}},P=function(e,r,t,n){return n&&g(n)?(d(r[n])||(r[n]={}),r[n][t]=e):r[t]=e,e},H=function(r,t,n,a,o,i){if(!g(r))return e.error(f+" A layername must be a string"),!1;if(!d(t))return e.error(f+" You must add layers to the directive if the markers are going to use this functionality."),!1;if(!d(t.overlays)||!d(t.overlays[r]))return e.error(f+' A marker can only be added to a layer of type "group"'),!1;var l=t.overlays[r];return l instanceof L.LayerGroup||l instanceof L.FeatureGroup?(l.addLayer(a),!o&&i.hasLayer(a)&&n.focus===!0&&a.openPopup(),!0):(e.error(f+' Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"'),!1)},M=function(r,t,n,a,o,i,s,u,c,g){for(var L in t)if(!g[L])if(-1===L.search("-")){var w=p.copy(t[L]),k=p.getObjectDotPath(c?[c,L]:[L]),C=S(i,L,c);if(d(C)){var A=d(A)?n[L]:void 0;y(w,A,C,k,s,o,a)}else{var D=b(w),M=(w?w.layer:void 0)||c;if(!d(D)){e.error(f+" Received invalid data on the marker "+L+".");continue}if(P(D,i,L,c),d(w.message)&&D.bindPopup(w.message,w.popupOptions),d(w.group)){var O=d(w.groupOption)?w.groupOption:null;h(D,w.group,O,a)}if(p.LabelPlugin.isLoaded()&&d(w.label)&&d(w.label.message)&&D.bindLabel(w.label.message,w.label.options),d(w)&&(d(w.layer)||d(c))){var x=H(M,o,w,D,u.individual.doWatch,a);if(!x)continue}else d(w.group)||(a.addLayer(D),u.individual.doWatch||w.focus!==!0||D.openPopup());u.individual.doWatch&&v(D,k,s,o,a,u.individual.isDeep),m(D,w,s,u.individual.doWatch,a),l.bindEvents(r,D,k,w,s,M)}}else e.error('The marker can\'t use a "-" on his key name: "'+L+'".')},O=function(r,t,n,a,o){var i,l,s=!1,u=!1,c=d(t);for(var g in n)s||(e.debug(f+"[markers] destroy: "),s=!0),c&&(l=r[g],i=t[g],u=angular.equals(l,i)&&a),d(r)&&Object.keys(r).length&&d(r[g])&&Object.keys(r[g]).length&&!u||o&&p.isFunction(o)&&o(l,i,g)},x=function(r,t,n,a,o){O(r,t,n,!1,function(r,t,i){e.debug(f+"[marker] is deleting marker: "+i),w(n[i],a,o),delete n[i]})},E=function(r,t,n){var a={};return O(r,t,n,!0,function(r,t,n){e.debug(f+"[marker] is already rendered, marker: "+n),a[n]=r}),a};return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,r,a,o){var i=o[0],l=i.getLeafletScope();i.getMap().then(function(e){var r,i={};r=d(o[1])?o[1].getLayers:function(){var e=t.defer();return e.resolve(),e.promise};var s=l.markersWatchOptions||C;d(a.watchMarkers)&&(s.doWatch=s.individual.doWatch=!d(a.watchMarkers)||p.isTruthy(a.watchMarkers));var u=d(a.markersNested)&&p.isTruthy(a.markersNested);r().then(function(r){var t=function(t,n){return u?void k.each(t,function(t,a){var o=d(o)?n[a]:void 0;x(t,o,i[a],e,r)}):void x(t,n,i,e,r)},o=function(n,o){t(n,o);var c=null;return u?void k.each(n,function(t,u){var f=d(f)?o[u]:void 0;c=E(n[u],f,i[u]),M(a.id,t,o,e,r,i,l,s,u,c)}):(c=E(n,o,i),void M(a.id,n,o,e,r,i,l,s,void 0,c))};D(a.id,"markers",o,t),n.setMarkers(i,a.id),A(l,"markers",s,function(e,r){o(e,r)})})})}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log","leafletMapDefaults","leafletBoundsHelpers","leafletHelpers",function(e,r,t,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,a,o){var i=o.getLeafletScope(),l=t.isValidBounds,s=n.isNumber;o.getMap().then(function(e){i.$watch("maxbounds",function(r){if(!l(r))return void e.setMaxBounds();var n=t.createLeafletBounds(r);s(r.pad)&&(n=n.pad(r.pad)),e.setMaxBounds(n),a.center||a.lfCenter||e.fitBounds(n)})})}}}]),angular.module("leaflet-directive").directive("paths",["$log","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletPathEvents",function(e,r,t,n,a,o,i){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(l,s,u,c){var d=c[0],f=a.isDefined,p=a.isString,g=d.getLeafletScope(),v=g.paths,y=o.createPath,m=i.bindPathEvents,h=o.setPathOptions;d.getMap().then(function(o){var i,l=n.getDefaults(u.id);i=f(c[1])?c[1].getLayers:function(){var e=r.defer();return e.resolve(),e.promise},f(v)&&i().then(function(r){var n={};t.setPaths(n,u.id);var i=!f(u.watchPaths)||"true"===u.watchPaths,s=function(e,t){var n=g.$watch('paths["'+t+'"]',function(t,a){if(!f(t)){if(f(a.layer))for(var i in r.overlays){var l=r.overlays[i];l.removeLayer(e)}return o.removeLayer(e),void n()}h(e,t.type,t)},!0)};g.$watchCollection("paths",function(t){for(var c in n)f(t[c])||(o.removeLayer(n[c]),delete n[c]);for(var d in t)if(0!==d.search("\\$"))if(-1===d.search("-")){if(!f(n[d])){var v=t[d],b=y(d,t[d],l);if(f(b)&&f(v.message)&&b.bindPopup(v.message,v.popupOptions),a.LabelPlugin.isLoaded()&&f(v.label)&&f(v.label.message)&&b.bindLabel(v.label.message,v.label.options),f(v)&&f(v.layer)){if(!p(v.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(r)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(r.overlays)||!f(r.overlays[v.layer])){e.error('[AngularJS - Leaflet] A path can only be added to a layer of type "group"');continue}var w=r.overlays[v.layer];if(!(w instanceof L.LayerGroup||w instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type "group" or "featureGroup"');continue}n[d]=b,w.addLayer(b),i?s(b,d):h(b,v.type,v)}else f(b)&&(n[d]=b,o.addLayer(b),i?s(b,d):h(b,v.type,v));m(u.id,b,d,v,g)}}else e.error('[AngularJS - Leaflet] The path name "'+d+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData","leafletMapDefaults","leafletHelpers",function(e,r,t,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(a,o,i,l){var s=n.isDefined,u=l.getLeafletScope(),c=u.tiles;return s(c)&&s(c.url)?void l.getMap().then(function(e){var n,a=t.getDefaults(i.id);u.$watch("tiles",function(t,o){var l=a.tileLayerOptions,u=a.tileLayer;return!s(t.url)&&s(n)?void e.removeLayer(n):s(n)?!s(t.url)||!s(t.options)||t.type===o.type&&angular.equals(t.options,l)?void(s(t.url)&&n.setUrl(t.url)):(e.removeLayer(n),l=a.tileLayerOptions,angular.copy(t.options,l),u=t.url,n="wms"===t.type?L.tileLayer.wms(u,l):L.tileLayer(u,l),n.addTo(e),void r.setTiles(n,i.id)):(s(t.options)&&angular.copy(t.options,l),s(t.url)&&(u=t.url),n="wms"===t.type?L.tileLayer.wms(u,l):L.tileLayer(u,l),n.addTo(e),void r.setTiles(n,i.id))},!0)}):void e.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),["markers","geojson"].forEach(function(e){angular.module("leaflet-directive").directive(e+"WatchOptions",["$log","$rootScope","$q","leafletData","leafletHelpers",function(r,t,n,a,o){var i=o.isDefined,l=o.errorHeader,s=o.isObject,u=o.watchOptions;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(t,n,a,o){var c=o[0],d=c.getLeafletScope();c.getMap().then(function(){i(t[e+"WatchOptions"])&&(s(t[e+"WatchOptions"])?angular.extend(u,t[e+"WatchOptions"]):r.error(l+"["+e+"WatchOptions] is not an object"),d[e+"WatchOptions"]=u)})}}}])}),angular.module("leaflet-directive").factory("leafletEventsHelpersFactory",["$rootScope","$q","$log","leafletHelpers",function(e,r,t,n){var a=n.safeApply,o=n.isDefined,i=n.isObject,l=n.isArray,s=n.errorHeader,u=function(e,r){this.rootBroadcastName=e,t.debug("leafletEventsHelpersFactory: lObjectType: "+r+"rootBroadcastName: "+e),this.lObjectType=r};return u.prototype.getAvailableEvents=function(){return[]},u.prototype.genDispatchEvent=function(e,r,n,a,o,i,l,s,u){var c=this;return e=e||"",e&&(e="."+e),function(d){var f=c.rootBroadcastName+e+"."+r;t.debug(f),c.fire(a,f,n,d,d.target||o,l,i,s,u)}},u.prototype.fire=function(r,t,n,i,l,s,u,c,d){a(r,function(){var a={leafletEvent:i,leafletObject:l,modelName:u,model:s};o(c)&&angular.extend(a,{layerName:c}),"emit"===n?r.$emit(t,a):e.$broadcast(t,a)})},u.prototype.bindEvents=function(e,r,n,a,u,c,d){var f=[],p="emit",g=this;if(o(u.eventBroadcast))if(i(u.eventBroadcast))if(o(u.eventBroadcast[g.lObjectType]))if(i(u.eventBroadcast[g.lObjectType])){o(u.eventBroadcast[this.lObjectType].logic)&&"emit"!==u.eventBroadcast[g.lObjectType].logic&&"broadcast"!==u.eventBroadcast[g.lObjectType].logic&&t.warn(s+"Available event propagation logic are: 'emit' or 'broadcast'.");var v=!1,y=!1;o(u.eventBroadcast[g.lObjectType].enable)&&l(u.eventBroadcast[g.lObjectType].enable)&&(v=!0),o(u.eventBroadcast[g.lObjectType].disable)&&l(u.eventBroadcast[g.lObjectType].disable)&&(y=!0),v&&y?t.warn(s+"can not enable and disable events at the same time"):v||y?v?u.eventBroadcast[this.lObjectType].enable.forEach(function(e){-1!==f.indexOf(e)?t.warn(s+"This event "+e+" is already enabled"):-1===g.getAvailableEvents().indexOf(e)?t.warn(s+"This event "+e+" does not exist"):f.push(e)}):(f=this.getAvailableEvents(),u.eventBroadcast[g.lObjectType].disable.forEach(function(e){var r=f.indexOf(e);-1===r?t.warn(s+"This event "+e+" does not exist or has been already disabled"):f.splice(r,1)})):t.warn(s+"must enable or disable events")}else t.warn(s+"event-broadcast."+[g.lObjectType]+" must be an object check your model.");else f=this.getAvailableEvents();else t.error(s+"event-broadcast must be an object check your model.");else f=this.getAvailableEvents();return f.forEach(function(t){r.on(t,g.genDispatchEvent(e,t,p,u,r,n,a,c,d))}),p},u}]).service("leafletEventsHelpers",["leafletEventsHelpersFactory",function(e){return new e}]),angular.module("leaflet-directive").factory("leafletGeoJsonEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpersFactory","leafletData",function(e,r,t,n,a,o){var i=n.safeApply,l=a,s=function(){l.call(this,"leafletDirectiveGeoJson","geojson")};return s.prototype=new l,s.prototype.genDispatchEvent=function(r,t,n,a,s,u,c,d,f){var p=l.prototype.genDispatchEvent.call(this,r,t,n,a,s,u,c,d),g=this;return function(r){"mouseout"===t&&(f.resetStyleOnMouseout&&o.getGeoJSON(f.mapId).then(function(e){var t=d?e[d]:e;t.resetStyle(r.target)}),i(a,function(){e.$broadcast(g.rootBroadcastName+".mouseout",r)})),p(r)}},s.prototype.getAvailableEvents=function(){return["click","dblclick","mouseover","mouseout"]},new s}]),angular.module("leaflet-directive").factory("leafletLabelEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpersFactory",function(e,r,t,n,a){var o=n,i=a,l=function(){i.call(this,"leafletDirectiveLabel","markers")};return l.prototype=new i,l.prototype.genDispatchEvent=function(e,r,t,n,a,o,l,s){var u=o.replace("markers.","");return i.prototype.genDispatchEvent.call(this,e,r,t,n,a,u,l,s)},l.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},l.prototype.genEvents=function(e,r,t,n,a,i,l,s){var u=this,c=this.getAvailableEvents(),d=o.getObjectArrayPath("markers."+i);c.forEach(function(r){a.label.on(r,u.genDispatchEvent(e,r,t,n,a.label,d,l,s))})},l.prototype.bindEvents=function(e,r,t,n,a,o){},new l}]),angular.module("leaflet-directive").factory("leafletMapEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpers","leafletIterators",function(e,r,t,n,a,o){var i=n.isDefined,l=a.fire,s=function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomanim","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},u=function(e,r,n,a){return a&&(a+="."),function(o){var i="leafletDirectiveMap."+a+r;t.debug(i),l(e,i,n,o,o.target,e)}},c=function(e){e.$broadcast("boundsChanged")},d=function(e,r,t,n){if(i(t.urlHashCenter)){var a=r.getCenter(),o=a.lat.toFixed(4)+":"+a.lng.toFixed(4)+":"+r.getZoom();i(n.c)&&n.c===o||e.$emit("centerUrlHash",o)}},f=function(e,r,t,n,a){o.each(r,function(r){var o={};o[t]=r,e.on(r,u(n,r,a,e._container.id||""),o)})};return{getAvailableMapEvents:s,genDispatchMapEvent:u,notifyCenterChangedToBounds:c,notifyCenterUrlHashChanged:d,addEvents:f}}]),angular.module("leaflet-directive").factory("leafletMarkerEvents",["$rootScope","$q","$log","leafletHelpers","leafletEventsHelpersFactory","leafletLabelEvents",function(e,r,t,n,a,o){var i=n.safeApply,l=n.isDefined,s=n,u=o,c=a,d=function(){c.call(this,"leafletDirectiveMarker","markers")};return d.prototype=new c,d.prototype.genDispatchEvent=function(r,t,n,a,o,l,s,u){var d=c.prototype.genDispatchEvent.call(this,r,t,n,a,o,l,s,u);return function(r){"click"===t?i(a,function(){e.$broadcast("leafletDirectiveMarkersClick",l)}):"dragend"===t&&(i(a,function(){s.lat=o.getLatLng().lat,s.lng=o.getLatLng().lng}),s.message&&s.focus===!0&&o.openPopup()),d(r)}},d.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose","touchend","touchstart","touchmove","touchcancel","touchleave"]},d.prototype.bindEvents=function(e,r,t,n,a,o){var i=c.prototype.bindEvents.call(this,e,r,t,n,a,o);s.LabelPlugin.isLoaded()&&l(r.label)&&u.genEvents(e,t,i,a,r,n,o)},new d}]),angular.module("leaflet-directive").factory("leafletPathEvents",["$rootScope","$q","$log","leafletHelpers","leafletLabelEvents","leafletEventsHelpers",function(e,r,t,n,a,o){var i=n.isDefined,l=n.isObject,s=n,u=n.errorHeader,c=a,d=o.fire,f=function(e,r,n,a,o,i,l,s){return e=e||"",e&&(e="."+e),function(u){var c="leafletDirectivePath"+e+"."+r;t.debug(c),d(a,c,n,u,u.target||o,l,i,s)}},p=function(e,r,n,a,o){var d,p,v=[],y="broadcast";if(i(o.eventBroadcast))if(l(o.eventBroadcast))if(i(o.eventBroadcast.path))if(l(o.eventBroadcast.paths))t.warn(u+"event-broadcast.path must be an object check your model.");else{void 0!==o.eventBroadcast.path.logic&&null!==o.eventBroadcast.path.logic&&("emit"!==o.eventBroadcast.path.logic&&"broadcast"!==o.eventBroadcast.path.logic?t.warn(u+"Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===o.eventBroadcast.path.logic&&(y="emit"));var m=!1,h=!1;if(void 0!==o.eventBroadcast.path.enable&&null!==o.eventBroadcast.path.enable&&"object"==typeof o.eventBroadcast.path.enable&&(m=!0),void 0!==o.eventBroadcast.path.disable&&null!==o.eventBroadcast.path.disable&&"object"==typeof o.eventBroadcast.path.disable&&(h=!0),m&&h)t.warn(u+"can not enable and disable events at the same time");else if(m||h)if(m)for(d=0;d<o.eventBroadcast.path.enable.length;d++)p=o.eventBroadcast.path.enable[d],-1!==v.indexOf(p)?t.warn(u+"This event "+p+" is already enabled"):-1===g().indexOf(p)?t.warn(u+"This event "+p+" does not exist"):v.push(p);else for(v=g(),d=0;d<o.eventBroadcast.path.disable.length;d++){p=o.eventBroadcast.path.disable[d];var L=v.indexOf(p);-1===L?t.warn(u+"This event "+p+" does not exist or has been already disabled"):v.splice(L,1)}else t.warn(u+"must enable or disable events")}else v=g();else t.error(u+"event-broadcast must be an object check your model.");else v=g();for(d=0;d<v.length;d++)p=v[d],r.on(p,f(e,p,y,o,v,n));s.LabelPlugin.isLoaded()&&i(r.label)&&c.genEvents(e,n,y,o,r,a)},g=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailablePathEvents:g,bindPathEvents:p}}])}(angular),function(e,r){"undefined"!=typeof module&&module.exports?module.exports=r(require("angular")):"function"==typeof define&&define.amd?define(["angular"],r):r(e.angular)}(window,function(e){e.module("angucomplete-alt",[]).directive("angucompleteAlt",["$q","$parse","$http","$sce","$timeout","$templateCache","$interpolate",function(e,r,t,n,a,o,i){function l(r,o,i,l){function k(e,t){e&&("object"==typeof e?(r.searchStr=H(e),D({originalObject:e})):"string"==typeof e&&e.length>0?r.searchStr=e:console&&console.error&&console.error("Tried to set "+(t?"initial":"")+" value of angucomplete to",e,"which is an invalid value"),x(!0))}function C(e){fe=null,r.hideResults(e),document.body.removeEventListener("click",C)}function A(e){return e.which?e.which:e.keyCode}function D(e){"function"==typeof r.selectedObject?r.selectedObject(e):r.selectedObject=e,x(e?!0:!1)}function S(e){return function(t){return r[e]?r[e](t):t}}function P(e){D({originalObject:e}),r.clearSelected&&(r.searchStr=null),W()}function H(e){return r.titleField.split(",").map(function(r){return M(e,r)}).join(" ")}function M(e,r){var t,n;if(r){t=r.split("."),n=e;for(var a=0;a<t.length;a++)n=n[t[a]]}else n=e;return n}function O(e,t){var a,o,i;return i=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e?(e.match&&e.replace||(e=e.toString()),o=e.match(i),a=o?e.replace(i,'<span class="'+r.matchClass+'">'+o[0]+"</span>"):e,n.trustAsHtml(a)):void 0}function x(e){r.notEmpty=e,se=r.searchStr,r.fieldRequired&&l&&r.inputName&&l[r.inputName].$setValidity(le,e)}function E(e){var t=A(e);if(t!==d&&t!==u)if(t===c||t===p)e.preventDefault();else if(t===s)e.preventDefault(),!r.showDropdown&&r.searchStr&&r.searchStr.length>=oe&&(Z(),r.searching=!0,_(r.searchStr));else if(t===f)W(),r.$apply(function(){ae.val(r.searchStr)});else{if(0===oe&&!r.searchStr)return;r.searchStr&&""!==r.searchStr?r.searchStr.length>=oe&&(Z(),ie&&a.cancel(ie),r.searching=!0,ie=a(function(){_(r.searchStr)},r.pause)):r.showDropdown=!1,se&&se!==r.searchStr&&!r.clearSelected&&r.$apply(function(){D()})}}function $(e){!r.overrideSuggestions||r.selectedObject&&r.selectedObject.originalObject===r.searchStr||(e&&e.preventDefault(),a.cancel(ie),R(),P(r.searchStr))}function T(e){var r=getComputedStyle(e);return e.offsetHeight+parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function I(){return ce.getBoundingClientRect().top+parseInt(getComputedStyle(ce).maxHeight,10)}function B(){return o[0].querySelectorAll(".angucomplete-row")[r.currentIndex]}function F(){return B().getBoundingClientRect().top-(ce.getBoundingClientRect().top+parseInt(getComputedStyle(ce).paddingTop,10))}function G(e){ce.scrollTop=ce.scrollTop+e}function q(){var e=r.results[r.currentIndex];r.matchClass?ae.val(H(e.originalObject)):ae.val(e.title)}function j(e){var t=A(e),n=null,a=null;t===p&&r.results?(r.currentIndex>=0&&r.currentIndex<r.results.length?(e.preventDefault(),r.selectResult(r.results[r.currentIndex])):($(e),W()),r.$apply()):t===s&&r.results?(e.preventDefault(),r.currentIndex+1<r.results.length&&r.showDropdown&&(r.$apply(function(){r.currentIndex++,q()}),de&&(n=B(),I()<n.getBoundingClientRect().bottom&&G(T(n))))):t===c&&r.results?(e.preventDefault(),r.currentIndex>=1?(r.$apply(function(){r.currentIndex--,q()}),de&&(a=F(),0>a&&G(a-1))):0===r.currentIndex&&r.$apply(function(){r.currentIndex=-1,ae.val(r.searchStr)})):t===g?r.results&&r.results.length>0&&r.showDropdown?-1===r.currentIndex&&r.overrideSuggestions?$():(-1===r.currentIndex&&(r.currentIndex=0),r.selectResult(r.results[r.currentIndex]),r.$digest()):r.searchStr&&r.searchStr.length>0&&$():t===f&&e.preventDefault()}function N(e){return function(t,n,a,o){n||a||o||!t.data||(t=t.data),r.searching=!1,K(M(ee(t),r.remoteUrlDataField),e)}}function z(e,t,n,a){0!==t&&-1!==t&&(t||n||a||(t=e.status),r.remoteUrlErrorCallback?r.remoteUrlErrorCallback(e,t,n,a):console&&console.error&&console.error("http error"))}function R(){ue&&ue.resolve()}function U(n){var a={},o=r.remoteUrl+encodeURIComponent(n);r.remoteUrlRequestFormatter&&(a={params:r.remoteUrlRequestFormatter(n)},o=r.remoteUrl),r.remoteUrlRequestWithCredentials&&(a.withCredentials=!0),R(),ue=e.defer(),a.timeout=ue.promise,t.get(o,a).success(N(n)).error(z)}function J(t){R(),ue=e.defer(),r.remoteApiHandler(t,ue.promise).then(N(t))["catch"](z)}function W(){r.showDropdown=!1,r.results=[],ce&&(ce.scrollTop=0)}function Z(){r.showDropdown=te,r.currentIndex=r.focusFirst?0:-1,r.results=[]}function V(e){var t,n,a,o,i=r.searchFields.split(","),l=[];for("undefined"!=typeof r.parseInput()&&(e=r.parseInput()(e)),t=0;t<r.localData.length;t++){for(n=!1,a=0;a<i.length;a++)o=M(r.localData[t],i[a])||"",n=n||o.toString().toLowerCase().indexOf(e.toString().toLowerCase())>=0;n&&(l[l.length]=r.localData[t])}r.searching=!1,K(l,e)}function Y(e,t,n){if(!n)return!1;for(var a in t)if(t[a].toLowerCase()===n.toLowerCase())return r.selectResult(e),!0;return!1}function _(e){!e||e.length<oe||(r.localData?r.$apply(function(){V(e)}):r.remoteApiHandler?J(e):U(e))}function K(e,t){var n,a,o,i,l,s;if(e&&e.length>0)for(r.results=[],n=0;n<e.length;n++)r.titleField&&""!==r.titleField&&(i=l=H(e[n])),a="",r.descriptionField&&(a=s=M(e[n],r.descriptionField)),o="",r.imageField&&(o=M(e[n],r.imageField)),r.matchClass&&(l=O(i,t),s=O(a,t)),r.results[r.results.length]={title:l,description:s,image:o,originalObject:e[n]};else r.results=[];r.autoMatch&&1===r.results.length&&Y(r.results[0],{title:i,desc:a||""},r.searchStr)?r.showDropdown=!1:0!==r.results.length||ne?r.showDropdown=!0:r.showDropdown=!1}function Q(){r.localData?K(r.localData,""):r.remoteApiHandler?J(""):U("")}var X,ee,re,te,ne,ae=o.find("input"),oe=v,ie=null,le=L,se=null,ue=null,ce=o[0].querySelector(".angucomplete-dropdown"),de=!1,fe=null;o.on("mousedown",function(e){e.target.id?(fe=e.target.id,fe===r.id+"_dropdown"&&document.body.addEventListener("click",C)):fe=e.target.className}),r.currentIndex=r.focusFirst?0:null,r.searching=!1,re=r.$watch("initialValue",function(e){e&&(re(),k(e,!0))}),r.$watch("fieldRequired",function(e,t){e!==t&&(e?x(se&&-1!==r.currentIndex?!0:!1):l[r.inputName].$setValidity(le,!0))}),r.$on("angucomplete-alt:clearInput",function(e,t){t&&t!==r.id||(r.searchStr=null,D(),x(!1),W())}),r.$on("angucomplete-alt:changeInput",function(e,t,n){t&&t===r.id&&k(n)}),r.onFocusHandler=function(){r.focusIn&&r.focusIn(),0!==oe||r.searchStr&&0!==r.searchStr.length||(r.currentIndex=r.focusFirst?0:r.currentIndex,r.showDropdown=!0,Q())},r.hideResults=function(){fe&&(fe===r.id+"_dropdown"||fe.indexOf("angucomplete")>=0)?fe=null:(X=a(function(){W(),r.$apply(function(){r.searchStr&&r.searchStr.length>0&&ae.val(r.searchStr)})},h),R(),r.focusOut&&r.focusOut(),r.overrideSuggestions&&r.searchStr&&r.searchStr.length>0&&-1===r.currentIndex&&$())},r.resetHideResults=function(){X&&a.cancel(X)},r.hoverRow=function(e){r.currentIndex=e},r.selectResult=function(e){r.matchClass&&(e.title=H(e.originalObject),e.description=M(e.originalObject,r.descriptionField)),
r.clearSelected?r.searchStr=null:r.searchStr=e.title,D(e),W()},r.inputChangeHandler=function(e){return e.length<oe?(R(),W()):0===e.length&&0===oe&&(r.searching=!1,Q()),r.inputChanged&&(e=r.inputChanged(e)),e},r.fieldRequiredClass&&""!==r.fieldRequiredClass&&(le=r.fieldRequiredClass),r.minlength&&""!==r.minlength&&(oe=parseInt(r.minlength,10)),r.pause||(r.pause=m),r.clearSelected||(r.clearSelected=!1),r.overrideSuggestions||(r.overrideSuggestions=!1),r.fieldRequired&&l&&x(r.initialValue?!0:!1),r.inputType=i.type?i.type:"text",r.textSearching=i.textSearching?i.textSearching:b,r.textNoResults=i.textNoResults?i.textNoResults:w,te="false"===r.textSearching?!1:!0,ne="false"===r.textNoResults?!1:!0,r.maxlength=i.maxlength?i.maxlength:y,ae.on("keydown",j),ae.on("keyup",E),ee=S("remoteUrlResponseFormatter"),a(function(){var e=getComputedStyle(ce);de=e.maxHeight&&"auto"===e.overflowY})}var s=40,u=39,c=38,d=37,f=27,p=13,g=9,v=3,y=524288,m=500,h=200,L="autocomplete-required",b="Searching...",w="No results found",k="/angucomplete-alt/index.html";return o.put(k,'<div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}">  <input id="{{id}}_value" name="{{inputName}}" ng-class="{\'angucomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/>  <div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-show="showDropdown">    <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>    <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>    <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="angucomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="angucomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="angucomplete-image-default"></div>      </div>      <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="angucomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",disableInput:"=",initialValue:"=",localData:"=",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"=",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",inputName:"@",focusFirst:"@",parseInput:"&"},templateUrl:function(e,r){return r.templateUrl||k},compile:function(e){var r=i.startSymbol(),t=i.endSymbol();if("{{"!==r||"}}"!==t){var n=e.html().replace(/\{\{/g,r).replace(/\}\}/g,t);e.html(n)}return l}}}])});var app=angular.module("loydaLahde",["nemLogging","leaflet-directive","angucomplete-alt"]);app.config(function(e){}),app.controller("FrontPageMapController",["$scope","$http",function(e,r){e.springList={};var t="fa-check-circle-o",n="green";r.get("/api/springs").then(function(r){console.log("Success",r),r.data.forEach(function(r,a){switch(r.status){case"juomakelpoista":t="fa-check-circle",n="green";break;case"ei tietoa":t="fa-question-circle",n="orange";break;case"ei juomakelpoista":t="fa-exclamation",n="red"}e.springList[a]={lat:r.location.coordinates[1],lng:r.location.coordinates[0],message:"<h4>"+r.title+"</h4><p>Lähteen tila: <strong>"+r.status+"</strong></p><p>Lähteen laatu analysoitu: <strong>"+r.tested_at+"</strong></p>",focus:!1,draggable:!1,icon:{type:"awesomeMarker",prefix:"fa",icon:t,markerColor:n}}})},function(e){console.error("ERR",e)}),angular.extend(e,{finlandCenter:{lat:64.96,lng:27.59,zoom:5},markers:e.springList,defaults:{scrollWheelZoom:!1}})}]),app.controller("SingleSpringController",["$scope","$http",function(e,r){angular.extend(e,{defaults:{scrollWheelZoom:!1}})}]);